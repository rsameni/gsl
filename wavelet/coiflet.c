/* wavelet/coiflet.c */
/* Cheshmeh Inc. */

#include <config.h>
#include <gsl/gsl_errno.h>
#include <gsl/gsl_wavelet.h>

/* Coiflet 1 coefficients */
static const double h_1[6] = { -0.072732619512853897000000,
		  0.337897662457809220000000,
		  0.852572020212255420000000,
		  0.384864846864202860000000,
		 -0.072732619512853897000000,
		 -0.015655728135464540000000
};

static const double g_1[6] = {   -0.015655728135464540000000,
		  0.072732619512853897000000,
		  0.384864846864202860000000,
		 -0.852572020212255420000000,
		  0.337897662457809220000000,
		  0.072732619512853897000000
};

/* Coiflet 2 coefficients */
static const double h_2[12] = {  0.016387336463522112000000,
		 -0.041464936781759151000000,
		 -0.067372554721963018000000,
		  0.386110066821162220000000,
		  0.812723635445542270000000,
		  0.417005184421692540000000,
		 -0.076488599078306393000000,
		 -0.059434418646456898000000,
		  0.023680171946334084000000,
		  0.005611434819394499500000,
		 -0.001823208870702993200000,
		 -0.000720549445364512210000
};

static const double g_2[12] = { -0.000720549445364512210000,
		  0.001823208870702993200000,
		  0.005611434819394499500000,
		 -0.023680171946334084000000,
		 -0.059434418646456898000000,
		  0.076488599078306393000000,
		  0.417005184421692540000000,
		 -0.812723635445542270000000,
		  0.386110066821162220000000,
		  0.067372554721963018000000,
		 -0.041464936781759151000000,
		 -0.016387336463522112000000
};

/* Coiflet 3 coefficients */
static const double h_3[18] = {  -0.003793512864491014100000,
		  0.007782596427325418200000,
		  0.023452696141836267000000,
		 -0.065771911281855500000000,
		 -0.061123390002672869000000,
		  0.405176902409616900000000,
		  0.793777222625620560000000,
		  0.428483476377618740000000,
		 -0.071799821619312018000000,
		 -0.082301927106885983000000,
		  0.034555027573061628000000,
		  0.015880544863615904000000,
		 -0.009007976136661580500000,
		 -0.002574517688750223600000,
		  0.001117518770890601600000,
		  0.000466216960112886310000,
		 -0.000070983303138141252000,
		 -0.000034599772836212559000
};

static const double g_3[18] = {   -0.000034599772836212559000,
		  0.000070983303138141252000,
		  0.000466216960112886310000,
		 -0.001117518770890601600000,
		 -0.002574517688750223600000,
		  0.009007976136661580500000,
		  0.015880544863615904000000,
		 -0.034555027573061628000000,
		 -0.082301927106885983000000,
		  0.071799821619312018000000,
		  0.428483476377618740000000,
		 -0.793777222625620560000000,
		  0.405176902409616900000000,
		  0.061123390002672869000000,
		 -0.065771911281855500000000,
		 -0.023452696141836267000000,
		  0.007782596427325418200000,
		  0.003793512864491014100000
};

/* Coiflet 4 coefficients */
static const double h_4[24] = {  0.000892313668582314560000,
		 -0.001629492012601732600000,
		 -0.007346166327642093500000,
		  0.016068943964776348000000,
		  0.026682300156053072000000,
		 -0.081266699680878754000000,
		 -0.056077313316754807000000,
		  0.415308407030430260000000,
		  0.782238930920499010000000,
		  0.434386056491468500000000,
		 -0.066627474263425038000000,
		 -0.096220442033987982000000,
		  0.039334427123337491000000,
		  0.025082261844864097000000,
		 -0.015211731527946259000000,
		 -0.005658286686610719900000,
		  0.003751436157278457100000,
		  0.001266561929298944500000,
		 -0.000589020756244338310000,
		 -0.000259974552487713240000,
		  0.000062339034461007128000,
		  0.000031229875865345646000,
		 -0.000003259680236883367500,
		 -0.000001784985003088261400
};

static const double g_4[24] = { -0.000001784985003088261400,
		  0.000003259680236883367500,
		  0.000031229875865345646000,
		 -0.000062339034461007128000,
		 -0.000259974552487713240000,
		  0.000589020756244338310000,
		  0.001266561929298944500000,
		 -0.003751436157278457100000,
		 -0.005658286686610719900000,
		  0.015211731527946259000000,
		  0.025082261844864097000000,
		 -0.039334427123337491000000,
		 -0.096220442033987982000000,
		  0.066627474263425038000000,
		  0.434386056491468500000000,
		 -0.782238930920499010000000,
		  0.415308407030430260000000,
		  0.056077313316754807000000,
		 -0.081266699680878754000000,
		 -0.026682300156053072000000,
		  0.016068943964776348000000,
		  0.007346166327642093500000,
		 -0.001629492012601732600000,
		 -0.000892313668582314560000
};

/* Coiflet 5 coefficients */
static const double h_5[30] = { -0.000212080839803798270000,
		  0.000358589687895737850000,
		  0.002178236358109017800000,
		 -0.004159358781386048000000,
		 -0.010131117519849788000000,
		  0.023408156785839195000000,
		  0.028168028970936350000000,
		 -0.091920010559696244000000,
		 -0.052043163176243773000000,
		  0.421566206690851490000000,
		  0.774289603652956180000000,
		  0.437991626171837120000000,
		 -0.062035963962903569000000,
		 -0.105574208703338930000000,
		  0.041289208750181702000000,
		  0.032683574267111833000000,
		 -0.019761778942572639000000,
		 -0.009164231162481845800000,
		  0.006764185448053083200000,
		  0.002433373212657672200000,
		 -0.001662863702013083800000,
		 -0.000638131343045111420000,
		  0.000302259581813063150000,
		  0.000140541149702034370000,
		 -0.000041340432272512511000,
		 -0.000021315026809955787000,
		  0.000003734655175141404700,
		  0.000002063761851364681400,
		 -0.000000167442885768230170,
		 -0.000000095176572738191650
};

static const double g_5[30] = { -0.000000095176572738191650,
		  0.000000167442885768230170,
		  0.000002063761851364681400,
		 -0.000003734655175141404700,
		 -0.000021315026809955787000,
		  0.000041340432272512511000,
		  0.000140541149702034370000,
		 -0.000302259581813063150000,
		 -0.000638131343045111420000,
		  0.001662863702013083800000,
		  0.002433373212657672200000,
		 -0.006764185448053083200000,
		 -0.009164231162481845800000,
		  0.019761778942572639000000,
		  0.032683574267111833000000,
		 -0.041289208750181702000000,
		 -0.105574208703338930000000,
		  0.062035963962903569000000,
		  0.437991626171837120000000,
		 -0.774289603652956180000000,
		  0.421566206690851490000000,
		  0.052043163176243773000000,
		 -0.091920010559696244000000,
		 -0.028168028970936350000000,
		  0.023408156785839195000000,
		  0.010131117519849788000000,
		 -0.004159358781386048000000,
		 -0.002178236358109017800000,
		  0.000358589687895737850000,
		  0.000212080839803798270000
};

static int
coiflet_init (const double **h1, const double **g1, const double **h2,
                 const double **g2, size_t * nc, size_t * offset,
                 size_t member)
{
  switch (member)
    {
    case 1:
      *h1 = h_1;
      *g1 = g_1;
      *h2 = h_1;
      *g2 = g_1;
      break;

    case 2:
      *h1 = h_2;
      *g1 = g_2;
      *h2 = h_2;
      *g2 = g_2;
      break;

    case 3:
      *h1 = h_3;
      *g1 = g_3;
      *h2 = h_3;
      *g2 = g_3;
      break;

    case 4:
      *h1 = h_4;
      *g1 = g_4;
      *h2 = h_4;
      *g2 = g_4;
      break;

    case 5:
      *h1 = h_5;
      *g1 = g_5;
      *h2 = h_5;
      *g2 = g_5;
      break;


    default:
      return GSL_FAILURE;
    }

  *nc = 6*member;
  *offset = 0;

  return GSL_SUCCESS;
}

static int
coiflet_centered_init (const double **h1, const double **g1,
                          const double **h2, const double **g2, size_t * nc,
                          size_t * offset, size_t member)
{
  switch (member)
    {
    case 1:
      *h1 = h_1;
      *g1 = g_1;
      *h2 = h_1;
      *g2 = g_1;
      break;

    case 2:
      *h1 = h_2;
      *g1 = g_2;
      *h2 = h_2;
      *g2 = g_2;
      break;

    case 3:
      *h1 = h_3;
      *g1 = g_3;
      *h2 = h_3;
      *g2 = g_3;
      break;

    case 4:
      *h1 = h_4;
      *g1 = g_4;
      *h2 = h_4;
      *g2 = g_4;
      break;

    case 5:
      *h1 = h_5;
      *g1 = g_5;
      *h2 = h_5;
      *g2 = g_5;
      break;

    default:
      return GSL_FAILURE;
    }

  *nc = 6*member;
  *offset = ((*nc) >> 1);

  return GSL_SUCCESS;
}

static const gsl_wavelet_type coiflet_type = {
  "coiflet",
  &coiflet_init
};

static const gsl_wavelet_type coiflet_centered_type = {
  "coiflet-centered",
  &coiflet_centered_init
};

const gsl_wavelet_type *gsl_wavelet_coiflet = &coiflet_type;
const gsl_wavelet_type *gsl_wavelet_coiflet_centered = &coiflet_centered_type;
